# Sale of Airline Tickets

**Проект:** «Система продажи авиабилетов»
**Платформа:** Qt (Qt Creator 6.8.0)
**Язык:** C++ (Qt Widgets)
**Тип:** GUI-приложение — клиент для управления данными пассажиров, рейсов и операций продажи/возврата билетов.

---

## Краткое описание

Информационная система предназначена для ввода, хранения, обработки и вывода данных о пассажирах, авиарейсах и операциях продажи/возврата билетов. Цель — автоматизировать рутинные операции обслуживания клиентов, обеспечить корректное хранение данных и быстрый поиск по ключевым полям.

Ключевые возможности:

* регистрация/удаление/просмотр/поиск пассажиров;
* добавление/удаление/просмотр/поиск авиарейсов;
* продажа и возврат билетов с проверкой свободных мест;
* создание/загрузка/сохранение/удаление базы данных;
* удобный Qt-интерфейс (QTabWidget с 4 вкладками: Пассажиры, Рейсы, Билеты, Настройки).

---

## Функциональные требования (пользовательские сценарии)

### Управление пассажирами

* регистрация нового пассажира;
* удаление данных о пассажире;
* просмотр всех пассажиров;
* очистка таблицы пассажиров;
* поиск по номеру паспорта;
* поиск по фрагментам ФИО.

### Управление авиарейсами

* добавление нового рейса;
* удаление рейса (блокируется, если есть проданные билеты);
* просмотр всех рейсов;
* очистка таблицы рейсов;
* поиск по номеру рейса;
* поиск по фрагменту названия аэропорта прибытия.

### Продажа / возврат билетов

* регистрация продажи билета (проверка наличия свободных мест);
* регистрация возврата билета (проверка корректности номера билета);
* отображение доступных мест по рейсу.

### Настройки / работа с БД

* создать базу данных;
* загрузить/сохранить базу данных;
* создать копию (резервную) БД;
* удалить базу данных;
* обеспечить целостность данных и обработку ошибок.

---

## Алгоритмы и структуры данных (кратко)

### 1. AVL-дерево (для рейсов)

* Хранит рейсы по ключу — номер рейса формата `AAA-NNN` (строка).
* Поддерживает вставку, удаление и поиск за `O(log n)`.
* Реализован обратный (право→корень→лево) обход для вывода рейсов в порядке убывания номера.
* Узел содержит: указатель на объект `Flight`, высоту, ссылки на детей.

**Преимущества:** гарантированная сбалансированность, быстрая навигация, автоматическая сортировка по ключу.

---

### 2. Хеш-таблица с открытым хешированием (цепочки) — для пассажиров

* Таблица фиксированного размера (100 ячеек), каждая ячейка — список указателей на объекты `Passenger`.
* Хеш-функция (пример):

  ```
  h(x) = ( Σ_{i=1..n} (code(x[i]) * 31^(n-i)) ) mod 100
  ```

  где `x` — строка номера паспорта.
* Коллизии обрабатываются методом цепочек (linked lists).

**Преимущества:** амортизированное время доступа `O(1)` при равномерном распределении, простота.

---

### 3. Однонаправленный линейный список + сортировка подсчетом — для операций (билеты)

* Список операций продажи/возврата: память выделяется динамически.
* Для сортировки номеров билетов применяется **сортировка подсчетом**:

  1. Преобразование номера билета в целое `TicketNumberToInt`.
  2. Подсчёт частот в массиве размера `maxKey − minKey + 1`.
  3. Восстановление списка в порядке возрастания — линейная сложность по числу записей и диапазону ключей.

**Преимущества:** линейная сложность при небольшом диапазоне ключей, отсутствие сравнений.

---

### 4. Поиск подстроки — алгоритм Бойера–Мура

* Используется для быстрого поиска по описаниям/номерам/аэропортам (эффективен для больших текстов).
* Предварительно строится таблица смещений, затем поиск выполняется справа налево с большими сдвигами при несовпадении.

---

## Описание интерфейса (UI)

* Главный экран с `QTabWidget`: вкладки «Пассажиры», «Рейсы», «Билеты», «Настройки».
* Формы ввода: `QLineEdit`, `QDateEdit`, `QComboBox` с валидаторами (проверка формата номера рейса, номера паспорта и т.д.).
* Ошибки и предупреждения отображаются централизованно через `QMessageBox` с обработчиком `ErrorHandler`.
* При отсутствии загруженной БД вкладки «Пассажиры», «Рейсы», «Билеты» — неактивны.

---

## Обработка ошибок и валидация

* Все поля ввода проверяются валидаторами (формат номера паспорта, номер рейса `AAA-NNN`, даты).
* Все исключения и ошибки сохраняются в лог и показываются пользователю в `QMessageBox`.
* Удаление рейса блокируется, если на рейс есть проданные билеты.

